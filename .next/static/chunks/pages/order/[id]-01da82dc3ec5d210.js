(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[441],{5477:function(e,r,n){"use strict";var t=n(7462),i=n(5987),a=n(7294),s=n(6010),c=n(1591),o=n(3871),l=44,d=a.forwardRef((function(e,r){var n=e.classes,c=e.className,d=e.color,u=void 0===d?"primary":d,h=e.disableShrink,p=void 0!==h&&h,x=e.size,f=void 0===x?40:x,m=e.style,v=e.thickness,y=void 0===v?3.6:v,j=e.value,Z=void 0===j?0:j,g=e.variant,E=void 0===g?"indeterminate":g,S=(0,i.Z)(e,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),_={},k={},b={};if("determinate"===E||"static"===E){var P=2*Math.PI*((l-y)/2);_.strokeDasharray=P.toFixed(3),b["aria-valuenow"]=Math.round(Z),_.strokeDashoffset="".concat(((100-Z)/100*P).toFixed(3),"px"),k.transform="rotate(-90deg)"}return a.createElement("div",(0,t.Z)({className:(0,s.Z)(n.root,c,"inherit"!==u&&n["color".concat((0,o.Z)(u))],{determinate:n.determinate,indeterminate:n.indeterminate,static:n.static}[E]),style:(0,t.Z)({width:f,height:f},k,m),ref:r,role:"progressbar"},b,S),a.createElement("svg",{className:n.svg,viewBox:"".concat(22," ").concat(22," ").concat(l," ").concat(l)},a.createElement("circle",{className:(0,s.Z)(n.circle,p&&n.circleDisableShrink,{determinate:n.circleDeterminate,indeterminate:n.circleIndeterminate,static:n.circleStatic}[E]),style:_,cx:l,cy:l,r:(l-y)/2,fill:"none",strokeWidth:y})))}));r.Z=(0,c.Z)((function(e){return{root:{display:"inline-block"},static:{transition:e.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},determinate:{transition:e.transitions.create("transform")},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:e.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},circleDeterminate:{transition:e.transitions.create("stroke-dashoffset")},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}}),{name:"MuiCircularProgress",flip:!1})(d)},6616:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order/[id]",function(){return n(9741)}])},9741:function(e,r,n){"use strict";n.r(r),n.d(r,{__N_SSP:function(){return H}});var t=n(4051),i=n.n(t),a=n(5893),s=n(7294),c=n(5152),o=n(1641),l=n(7005),d=n(1664),u=n(2318),h=n(5477),p=n(1749),x=n(8463),f=n(2822),m=n(998),v=n(9659),y=n(6847),j=n(2302),Z=n(3750),g=n(7394),E=n(8222),S=n(9613),_=n(282),k=n(9669),b=n.n(k),P=n(1163),D=n(4940),w=n(8766),A=n(2252),C=n(5021);function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function O(e,r,n,t,i,a,s){try{var c=e[a](s),o=c.value}catch(l){return void n(l)}c.done?r(o):Promise.resolve(o).then(t,i)}function R(e){return function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function s(e){O(a,t,i,s,c,"next",e)}function c(e){O(a,t,i,s,c,"throw",e)}s(void 0)}))}}function T(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function N(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){T(e,r,n[r])}))}return e}function L(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a=[],s=!0,c=!1;try{for(n=n.call(e);!(s=(t=n.next()).done)&&(a.push(t.value),!r||a.length!==r);s=!0);}catch(o){c=!0,i=o}finally{try{s||null==n.return||n.return()}finally{if(c)throw i}}return a}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return I(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,r){switch(r.type){case"FETCH_REQUEST":return N({},e,{loading:!0,error:""});case"FETCH_SUCCESS":return N({},e,{loading:!1,order:r.payload,error:""});case"FETCH_FAIL":return N({},e,{loading:!1,error:r.payload});case"PAY_REQUEST":return N({},e,{loadingPay:!0});case"PAY_SUCCESS":return N({},e,{loadingPay:!1,successPay:!0});case"PAY_FAIL":return N({},e,{loadingPay:!1,errorPay:r.payload});case"PAY_RESET":return N({},e,{loadingPay:!1,successPay:!1,errorPay:""});case"DELIVER_REQUEST":return N({},e,{loadingDeliver:!0});case"DELIVER_SUCCESS":return N({},e,{loadingDeliver:!1,successDeliver:!0});case"DELIVER_FAIL":return N({},e,{loadingDeliver:!1,errorDeliver:r.payload});case"DELIVER_RESET":return N({},e,{loadingDeliver:!1,successDeliver:!1,errorDeliver:""})}}function F(e){var r=e.params.id,n=L((0,C.Up)(),2),t=n[0].isPending,c=n[1],k=(0,D.Z)(),I=(0,P.useRouter)(),O=(0,s.useContext)(l.yh).state.userInfo,T=(0,s.useReducer)(U,{loading:!0,order:{},error:""}),N=T[0],F=N.loading,H=N.error,V=N.order,Y=N.successPay,$=N.loadingDeliver,M=N.successDeliver,Q=T[1],z=V.shippingAddress,B=V.paymentMethod,q=V.orderItems,W=V.itemsPrice,X=V.taxPrice,G=V.shippingPrice,J=V.totalPrice,K=V.isPaid,ee=V.paidAt,re=V.isDelivered,ne=V.deliveredAt;(0,s.useEffect)((function(){if(!O)return I.push("/login");var e=function(){var e=R(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Q({type:"FETCH_REQUEST"}),e.next=4,b().get("/api/orders/".concat(r),{headers:{authorization:"Bearer ".concat(O.token)}});case 4:n=e.sent.data,Q({type:"FETCH_SUCCESS",payload:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),Q({type:"FETCH_FAIL",payload:(0,A.b)(e.t0)});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();if(!V._id||Y||M||V._id&&V._id!==r)e(),Y&&Q({type:"PAY_RESET"}),M&&Q({type:"DELIVER_RESET"});else{var n=function(){var e=R(i().mark((function e(){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b().get("/api/keys/paypal",{headers:{authorization:"Bearer ".concat(O.token)}});case 2:r=e.sent,n=r.data,c({type:"resetOptions",value:{"client-id":n,currency:"USD"}}),c({type:"setLoadingStatus",value:"pending"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n()}}),[V,Y,M]);var te=(0,w.Ds)().enqueueSnackbar;function ie(){return(ie=R(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Q({type:"DELIVER_REQUEST"}),e.next=4,b().put("/api/orders/".concat(V._id,"/deliver"),{},{headers:{authorization:"Bearer ".concat(O.token)}});case 4:r=e.sent.data,Q({type:"DELIVER_SUCCESS",payload:r}),te("Order is delivered",{variant:"success"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Q({type:"DELIVER_FAIL",payload:(0,A.b)(e.t0)}),te((0,A.b)(e.t0),{variant:"error"});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return(0,a.jsxs)(o.Z,{title:"Order ".concat(r),children:[(0,a.jsxs)(u.Z,{component:"h1",variant:"h1",children:["Order ",r]}),F?(0,a.jsx)(h.Z,{}):H?(0,a.jsx)(u.Z,{className:k.error,children:H}):(0,a.jsxs)(p.Z,{container:!0,spacing:1,children:[(0,a.jsxs)(p.Z,{item:!0,md:9,xs:12,children:[(0,a.jsx)(x.Z,{className:k.section,children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(m.Z,{children:(0,a.jsx)(u.Z,{component:"h2",variant:"h2",children:"Shipping Address"})}),(0,a.jsxs)(m.Z,{children:[z.fullName,", ",z.address,","," ",z.city,", ",z.postalCode,","," ",z.country,"\xa0",z.location&&(0,a.jsx)(v.Z,{variant:"button",target:"_new",href:"https://maps.google.com?q=".concat(z.location.lat,",").concat(z.location.lng),children:"Show On Map"})]}),(0,a.jsxs)(m.Z,{children:["Status:"," ",re?"delivered at ".concat(ne):"not delivered"]})]})}),(0,a.jsx)(x.Z,{className:k.section,children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(m.Z,{children:(0,a.jsx)(u.Z,{component:"h2",variant:"h2",children:"Payment Method"})}),(0,a.jsx)(m.Z,{children:B}),(0,a.jsxs)(m.Z,{children:["Status: ",K?"paid at ".concat(ee):"not paid"]})]})}),(0,a.jsx)(x.Z,{className:k.section,children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(m.Z,{children:(0,a.jsx)(u.Z,{component:"h2",variant:"h2",children:"Order Items"})}),(0,a.jsx)(m.Z,{children:(0,a.jsx)(y.Z,{children:(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(Z.Z,{children:(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(E.Z,{children:"Image"}),(0,a.jsx)(E.Z,{children:"Name"}),(0,a.jsx)(E.Z,{align:"right",children:"Quantity"}),(0,a.jsx)(E.Z,{align:"right",children:"Price"})]})}),(0,a.jsx)(S.Z,{children:q.map((function(e){return(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(E.Z,{children:(0,a.jsx)(d.default,{href:"/product/".concat(e.slug),passHref:!0,children:(0,a.jsx)(v.Z,{children:(0,a.jsx)("img",{src:e.image_url,alt:e.name,width:50,height:50})})})}),(0,a.jsx)(E.Z,{children:(0,a.jsx)(d.default,{href:"/product/".concat(e.slug),passHref:!0,children:(0,a.jsx)(v.Z,{children:(0,a.jsx)(u.Z,{children:e.name})})})}),(0,a.jsx)(E.Z,{align:"right",children:(0,a.jsx)(u.Z,{children:e.quantity})}),(0,a.jsx)(E.Z,{align:"right",children:(0,a.jsxs)(u.Z,{children:["$",e.price]})})]},e._id)}))})]})})})]})})]}),(0,a.jsx)(p.Z,{item:!0,md:3,xs:12,children:(0,a.jsx)(x.Z,{className:k.section,children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(m.Z,{children:(0,a.jsx)(u.Z,{variant:"h2",children:"Order Summary"})}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(p.Z,{container:!0,children:[(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsx)(u.Z,{children:"Items:"})}),(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsxs)(u.Z,{align:"right",children:["$",W]})})]})}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(p.Z,{container:!0,children:[(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsx)(u.Z,{children:"Tax:"})}),(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsxs)(u.Z,{align:"right",children:["$",X]})})]})}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(p.Z,{container:!0,children:[(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsx)(u.Z,{children:"Shipping:"})}),(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsxs)(u.Z,{align:"right",children:["$",G]})})]})}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(p.Z,{container:!0,children:[(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsx)(u.Z,{children:(0,a.jsx)("strong",{children:"Total:"})})}),(0,a.jsx)(p.Z,{item:!0,xs:6,children:(0,a.jsx)(u.Z,{align:"right",children:(0,a.jsxs)("strong",{children:["$",J]})})})]})}),!K&&(0,a.jsx)(m.Z,{children:t?(0,a.jsx)(h.Z,{}):(0,a.jsx)("div",{className:k.fullWidth,children:(0,a.jsx)(C.ch,{createOrder:function(e,r){return r.order.create({purchase_units:[{amount:{value:J}}]}).then((function(e){return e}))},onApprove:function(e,r){return r.order.capture().then(function(){var e=R(i().mark((function e(r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Q({type:"PAY_REQUEST"}),e.next=4,b().put("/api/orders/".concat(V._id,"/pay"),r,{headers:{authorization:"Bearer ".concat(O.token)}});case 4:n=e.sent.data,Q({type:"PAY_SUCCESS",payload:n}),te("Order is paid",{variant:"success"}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Q({type:"PAY_FAIL",payload:(0,A.b)(e.t0)}),te((0,A.b)(e.t0),{variant:"error"});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(r){return e.apply(this,arguments)}}())},onError:function(e){te((0,A.b)(e),{variant:"error"})}})})}),O.isAdmin&&V.isPaid&&!V.isDelivered&&(0,a.jsxs)(m.Z,{children:[$&&(0,a.jsx)(h.Z,{}),(0,a.jsx)(_.Z,{fullWidth:!0,variant:"contained",color:"primary",onClick:function(){return ie.apply(this,arguments)},children:"Deliver Order"})]})]})})})]})]})}var H=!0;r.default=(0,c.default)((function(){return Promise.resolve(F)}),{ssr:!1})}},function(e){e.O(0,[967,164,349,641,774,888,179],(function(){return r=6616,e(e.s=r);var r}));var r=e.O();_N_E=r}]);