(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[590],{8502:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/product/[id]",function(){return n(500)}])},500:function(e,r,n){"use strict";n.r(r),n.d(r,{__N_SSP:function(){return D}});var t=n(4051),a=n.n(t),i=n(5893),o=n(9669),u=n.n(o),c=n(5152),l=n(1163),s=n(1664),d=n(7294),p=n(1749),f=n(8463),h=n(2822),m=n(998),x=n(5757),j=n(2318),g=n(5477),v=n(8101),Z=n(282),y=n(553),S=n(797),b=n(2252),U=n(7005),E=n(1641),_=n(4940),k=n(7536),C=n(8766);function T(e,r,n,t,a,i,o){try{var u=e[i](o),c=u.value}catch(l){return void n(l)}u.done?r(c):Promise.resolve(c).then(t,a)}function P(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var i=e.apply(r,n);function o(e){T(i,t,a,o,u,"next",e)}function u(e){T(i,t,a,o,u,"throw",e)}o(void 0)}))}}function I(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function F(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){I(e,r,n[r])}))}return e}function w(e,r){switch(r.type){case"FETCH_REQUEST":return F({},e,{loading:!0,error:""});case"FETCH_SUCCESS":return F({},e,{loading:!1,error:""});case"FETCH_FAIL":return F({},e,{loading:!1,error:r.payload});case"UPDATE_REQUEST":return F({},e,{loadingUpdate:!0,errorUpdate:""});case"UPDATE_SUCCESS":return F({},e,{loadingUpdate:!1,errorUpdate:""});case"UPDATE_FAIL":return F({},e,{loadingUpdate:!1,errorUpdate:r.payload});case"UPLOAD_REQUEST":return F({},e,{loadingUpload:!0,errorUpload:""});case"UPLOAD_SUCCESS":return F({},e,{loadingUpload:!1,errorUpload:""});case"UPLOAD_FAIL":return F({},e,{loadingUpload:!1,errorUpload:r.payload});default:return e}}function A(e){var r=e.params.id,n=(0,d.useContext)(U.yh).state,t=(0,d.useReducer)(w,{loading:!0,error:""}),o=t[0],c=o.loading,T=o.error,I=o.loadingUpdate,A=o.loadingUpload,D=t[1],q=(0,k.cI)(),O=q.handleSubmit,Q=q.control,L=q.formState.errors,N=q.setValue,B=(0,C.Ds)(),H=B.enqueueSnackbar,V=B.closeSnackbar,W=(0,l.useRouter)(),R=(0,_.Z)(),z=n.userInfo;(0,d.useEffect)((function(){if(!z)return W.push("/login");var e=function(){var e=P(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D({type:"FETCH_REQUEST"}),e.next=4,u().get("/api/admin/products/".concat(r),{headers:{authorization:"Bearer ".concat(z.token)}});case 4:n=e.sent.data,D({type:"FETCH_SUCCESS"}),N("name",n.name),N("slug",n.slug),N("price",n.price),N("image",n.image),N("featuredImage",n.featuredImage),M(n.isFeatured),N("category",n.category),N("countInStock",n.countInStock),N("description",n.description),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),D({type:"FETCH_FAIL",payload:(0,b.b)(e.t0)});case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var X=function(){var e=P(a().mark((function e(r){var n,t,i,o,c=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"image",t=r.target.files[0],(i=new FormData).append("file",t),e.prev=4,D({type:"UPLOAD_REQUEST"}),e.next=8,u().post("/api/admin/upload",i,{headers:{"Content-Type":"multipart/form-data",authorization:"Bearer ".concat(z.token)}});case 8:o=e.sent.data,D({type:"UPLOAD_SUCCESS"}),N(n,o.secure_url),H("File uploaded successfully",{variant:"success"}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),D({type:"UPLOAD_FAIL",payload:(0,b.b)(e.t0)}),H((0,b.b)(e.t0),{variant:"error"});case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(r){return e.apply(this,arguments)}}(),G=function(){var e=P(a().mark((function e(n){var t,i,o,c,l,s,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.name,i=n.slug,o=n.price,c=n.category,l=n.image,s=n.countInStock,d=n.description,V(),e.prev=2,D({type:"UPDATE_REQUEST"}),e.next=6,u().put("/api/admin/products/".concat(r),{name:t,slug:i,price:o,category:c,image:l,isFeatured:K,countInStock:s,description:d},{headers:{authorization:"Bearer ".concat(z.token)}});case 6:D({type:"UPDATE_SUCCESS"}),H("Product updated successfully",{variant:"success"}),W.push("/admin/products"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),D({type:"UPDATE_FAIL",payload:(0,b.b)(e.t0)}),H((0,b.b)(e.t0),{variant:"error"});case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(r){return e.apply(this,arguments)}}(),J=(0,d.useState)(!1),K=J[0],M=J[1];return(0,i.jsx)(E.Z,{title:"Edit Product ".concat(r),children:(0,i.jsxs)(p.Z,{container:!0,spacing:1,children:[(0,i.jsx)(p.Z,{item:!0,md:3,xs:12,children:(0,i.jsx)(f.Z,{className:R.section,children:(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(s.default,{href:"/admin/dashboard",passHref:!0,children:(0,i.jsx)(m.Z,{button:!0,component:"a",children:(0,i.jsx)(x.Z,{primary:"Admin Dashboard"})})}),(0,i.jsx)(s.default,{href:"/admin/orders",passHref:!0,children:(0,i.jsx)(m.Z,{button:!0,component:"a",children:(0,i.jsx)(x.Z,{primary:"Orders"})})}),(0,i.jsx)(s.default,{href:"/admin/products",passHref:!0,children:(0,i.jsx)(m.Z,{selected:!0,button:!0,component:"a",children:(0,i.jsx)(x.Z,{primary:"Products"})})}),(0,i.jsx)(s.default,{href:"/admin/users",passHref:!0,children:(0,i.jsx)(m.Z,{button:!0,component:"a",children:(0,i.jsx)(x.Z,{primary:"Users"})})})]})})}),(0,i.jsx)(p.Z,{item:!0,md:9,xs:12,children:(0,i.jsx)(f.Z,{className:R.section,children:(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(m.Z,{children:(0,i.jsxs)(j.Z,{component:"h1",variant:"h1",children:["Edit Product ",r]})}),(0,i.jsxs)(m.Z,{children:[c&&(0,i.jsx)(g.Z,{}),T&&(0,i.jsx)(j.Z,{className:R.error,children:T})]}),(0,i.jsx)(m.Z,{children:(0,i.jsx)("form",{onSubmit:O(G),className:R.form,children:(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"name",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"name",label:"Name",error:Boolean(L.name),helperText:L.name?"Name is required":""},r))}})}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"slug",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"slug",label:"Slug",error:Boolean(L.slug),helperText:L.slug?"Slug is required":""},r))}})}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"price",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"price",label:"Price",error:Boolean(L.price),helperText:L.price?"Price is required":""},r))}})}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"image",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"image",label:"Image",error:Boolean(L.image),helperText:L.image?"Image is required":""},r))}})}),(0,i.jsxs)(m.Z,{children:[(0,i.jsxs)(Z.Z,{variant:"contained",component:"label",children:["Upload File",(0,i.jsx)("input",{type:"file",onChange:X,hidden:!0})]}),A&&(0,i.jsx)(g.Z,{})]}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(y.Z,{label:"Is Featured",control:(0,i.jsx)(S.Z,{onClick:function(e){return M(e.target.checked)},checked:K,name:"isFeatured"})})}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"featuredImage",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"featuredImage",label:"Featured Image",error:Boolean(L.image),helperText:L.image?"Featured Image is required":""},r))}})}),(0,i.jsxs)(m.Z,{children:[(0,i.jsxs)(Z.Z,{variant:"contained",component:"label",children:["Upload File",(0,i.jsx)("input",{type:"file",onChange:function(e){return X(e,"featuredImage")},hidden:!0})]}),A&&(0,i.jsx)(g.Z,{})]}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"category",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"category",label:"Category",error:Boolean(L.category),helperText:L.category?"Category is required":""},r))}})}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"countInStock",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,id:"countInStock",label:"Count in stock",error:Boolean(L.countInStock),helperText:L.countInStock?"Count in stock is required":""},r))}})}),(0,i.jsx)(m.Z,{children:(0,i.jsx)(k.Qr,{name:"description",control:Q,defaultValue:"",rules:{required:!0},render:function(e){var r=e.field;return(0,i.jsx)(v.Z,F({variant:"outlined",fullWidth:!0,multiline:!0,id:"description",label:"Description",error:Boolean(L.description),helperText:L.description?"Description is required":""},r))}})}),(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(Z.Z,{variant:"contained",type:"submit",fullWidth:!0,color:"primary",children:"Update"}),I&&(0,i.jsx)(g.Z,{})]})]})})})]})})})]})})}var D=!0;r.default=(0,c.default)((function(){return Promise.resolve(A)}),{ssr:!1})}},function(e){e.O(0,[967,164,924,101,536,522,641,774,888,179],(function(){return r=8502,e(e.s=r);var r}));var r=e.O();_N_E=r}]);