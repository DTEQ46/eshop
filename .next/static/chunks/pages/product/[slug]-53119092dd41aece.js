(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{3796:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/product/[slug]",function(){return r(2924)}])},2924:function(e,n,r){"use strict";r.r(n),r.d(n,{__N_SSP:function(){return E},default:function(){return C}});var t=r(4051),i=r.n(t),c=r(5893),s=r(7294),a=r(1664),u=r(9659),o=r(2318),l=r(1749),d=r(2822),h=r(998),x=r(8463),j=r(282),f=r(8101),v=r(5477),p=r(7926),Z=r(1641),m=r(4940),w=r(9669),b=r.n(w),y=r(7005),g=r(2252),_=r(1163),k=r(8766);function S(e,n,r,t,i,c,s){try{var a=e[c](s),u=a.value}catch(o){return void r(o)}a.done?n(u):Promise.resolve(u).then(t,i)}function P(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var c=e.apply(n,r);function s(e){S(c,t,i,s,a,"next",e)}function a(e){S(c,t,i,s,a,"throw",e)}s(void 0)}))}}function O(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function N(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){O(e,n,r[n])}))}return e}var E=!0;function C(e){var n=(0,_.useRouter)(),r=(0,s.useContext)(y.yh),t=r.state,w=r.dispatch,S=t.userInfo,O=e.product,E=(0,m.Z)(),C=(0,k.Ds)().enqueueSnackbar,I=(0,s.useState)([]),D=I[0],R=I[1],A=(0,s.useState)(0),T=A[0],q=A[1],W=(0,s.useState)(""),F=W[0],X=W[1],z=(0,s.useState)(!1),B=z[0],H=z[1],L=function(){var e=P(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),H(!0),e.prev=2,e.next=5,b().post("/api/products/".concat(O._id,"/reviews"),{rating:T,comment:F},{headers:{authorization:"Bearer ".concat(S.token)}});case 5:H(!1),C("Review submitted successfully",{variant:"success"}),M(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),H(!1),C((0,g.b)(e.t0),{variant:"error"});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(n){return e.apply(this,arguments)}}(),M=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b().get("/api/products/".concat(O._id,"/reviews"));case 3:n=e.sent.data,R(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),C((0,g.b)(e.t0),{variant:"error"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();if((0,s.useEffect)((function(){M()}),[]),!O)return(0,c.jsx)("div",{children:"Product Not Found"});var U=function(){var e=P(i().mark((function e(){var r,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.cart.cartItems.find((function(e){return e._id===O._id})),c=r?r.quantity+1:1,e.next=4,b().get("/api/products/".concat(O._id));case 4:if(!(e.sent.data.countInStock<c)){e.next=8;break}return window.alert("Sorry. Product is out of stock"),e.abrupt("return");case 8:w({type:y.Ef.CART_ADD_ITEM,payload:N({},O,{quantity:c})}),n.push("/cart");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)(Z.Z,{title:O.name,description:O.description,children:[(0,c.jsx)("div",{className:E.section,children:(0,c.jsx)(a.default,{href:"/",passHref:!0,children:(0,c.jsx)(u.Z,{children:(0,c.jsx)(o.Z,{children:"back to products"})})})}),(0,c.jsxs)(l.Z,{container:!0,spacing:1,children:[(0,c.jsx)(l.Z,{item:!0,md:6,xs:12,children:(0,c.jsx)("img",{src:O.image_url,alt:O.name,width:640,height:640})}),(0,c.jsx)(l.Z,{item:!0,md:3,xs:12,children:(0,c.jsxs)(d.Z,{children:[(0,c.jsx)(h.Z,{children:(0,c.jsx)(o.Z,{component:"h1",variant:"h1",children:O.name})}),(0,c.jsx)(h.Z,{children:(0,c.jsxs)(o.Z,{children:["Category: ",O.category]})}),(0,c.jsxs)(h.Z,{children:[(0,c.jsx)(p.Z,{value:O.rating,readOnly:!0}),(0,c.jsx)(u.Z,{href:"#reviews",children:(0,c.jsxs)(o.Z,{children:["(",O.numReviews," reviews)"]})})]}),(0,c.jsx)(h.Z,{children:(0,c.jsxs)(o.Z,{children:[" Description: ",O.description]})})]})}),(0,c.jsx)(l.Z,{item:!0,md:3,xs:12,children:(0,c.jsx)(x.Z,{children:(0,c.jsxs)(d.Z,{children:[(0,c.jsx)(h.Z,{children:(0,c.jsxs)(l.Z,{container:!0,children:[(0,c.jsx)(l.Z,{item:!0,xs:6,children:(0,c.jsx)(o.Z,{children:"Price"})}),(0,c.jsx)(l.Z,{item:!0,xs:6,children:(0,c.jsxs)(o.Z,{children:["$",O.price]})})]})}),(0,c.jsx)(h.Z,{children:(0,c.jsxs)(l.Z,{container:!0,children:[(0,c.jsx)(l.Z,{item:!0,xs:6,children:(0,c.jsx)(o.Z,{children:"Status"})}),(0,c.jsx)(l.Z,{item:!0,xs:6,children:(0,c.jsx)(o.Z,{children:O.countInStock>0?"In stock":"Unavailable"})})]})}),(0,c.jsx)(h.Z,{children:(0,c.jsx)(j.Z,{fullWidth:!0,variant:"contained",color:"primary",onClick:U,children:"Add to cart"})})]})})})]}),(0,c.jsxs)(d.Z,{children:[(0,c.jsx)(h.Z,{children:(0,c.jsx)(o.Z,{variant:"h2",children:"Customer Reviews"})}),0===D.length&&(0,c.jsx)(h.Z,{children:"No review"}),D.map((function(e){return(0,c.jsx)(h.Z,{children:(0,c.jsxs)(l.Z,{container:!0,children:[(0,c.jsxs)(l.Z,{item:!0,className:E.reviewItem,children:[(0,c.jsx)(o.Z,{children:(0,c.jsx)("strong",{children:e.name})}),(0,c.jsx)(o.Z,{children:e.createdAt.substring(0,10)})]}),(0,c.jsxs)(l.Z,{item:!0,children:[(0,c.jsx)(p.Z,{value:e.rating,readOnly:!0}),(0,c.jsx)(o.Z,{children:e.comment})]})]})},e._id)})),(0,c.jsx)(h.Z,{children:S?(0,c.jsx)("form",{onSubmit:L,className:E.reviewForm,children:(0,c.jsxs)(d.Z,{children:[(0,c.jsx)(h.Z,{children:(0,c.jsx)(o.Z,{variant:"h2",children:"Leave your review"})}),(0,c.jsx)(h.Z,{children:(0,c.jsx)(f.Z,{multiline:!0,variant:"outlined",fullWidth:!0,name:"review",label:"Enter comment",value:F,onChange:function(e){return X(e.target.value)}})}),(0,c.jsx)(h.Z,{children:(0,c.jsx)(p.Z,{name:"simple-controlled",value:T,onChange:function(e){return q(e.target.value)}})}),(0,c.jsxs)(h.Z,{children:[(0,c.jsx)(j.Z,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",children:"Submit"}),B&&(0,c.jsx)(v.Z,{})]})]})}):(0,c.jsxs)(o.Z,{variant:"h2",children:["Please"," ",(0,c.jsx)(u.Z,{href:"/login?redirect=/product/".concat(O.slug),children:"login"})," ","to write a review"]})})]})]})}}},function(e){e.O(0,[967,164,924,101,206,641,774,888,179],(function(){return n=3796,e(e.s=n);var n}));var n=e.O();_N_E=n}]);